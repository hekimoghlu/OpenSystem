// RUN: %target-build-language -module-name Foundation -parse-as-library %S/../../stdlib/public/Darwin/Foundation/*.language `dirname %t`/../../../stdlib/public/Darwin/Foundation/8/*.language -emit-module-path %t.1.languagemodule
// RUN: %target-build-language -module-name Foundation -parse-as-library %S/../../stdlib/public/Darwin/Foundation/*.language `dirname %t`/../../../stdlib/public/Darwin/Foundation/8/*.language -emit-module-path %t.2.languagemodule
// RUN: diff <(toolchain-bcanalyzer -dump %t.1.languagemodule | sed -e 's/\.[0-9]\.languagemodule/\.x\.languagemodule/g') <(toolchain-bcanalyzer -dump %t.2.languagemodule | sed -e 's/\.[0-9]\.languagemodule/\.x\.languagemodule/g')

// REQUIRES: sr4342
// REQUIRES: objc_interop
// REQUIRES: PTRSIZE=64

// Compiling the same set of files twice, without modifying them (and without
// generating inlineable SIL) should produce the same languagemodule. We don't
// promise more than that at this time...

// This test (and Foundation-determinism-wmo.language) are known to be rather
// brittle, since they refer directly to sources in stdlib/public/ as well as
// gyb outputs in the build folder, and assume the Apple Foundation overlay can
// be built with a relatively simple command line. If it ever breaks, feel free
// to just disable it and file an SR.
