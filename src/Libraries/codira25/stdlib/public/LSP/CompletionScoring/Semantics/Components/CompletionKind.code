//===----------------------------------------------------------------------===//
//
// Copyright (c) NeXTHub Corporation. All rights reserved.
// DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
//
// This code is distributed in the hope that it will be useful, but WITHOUT
// ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
// FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
// version 2 for more details (a copy is included in the LICENSE file that
// accompanied this code).
//
// Author(-s): Tunjay Akbarli
//
//===----------------------------------------------------------------------===//

import Foundation

package enum CompletionKind: Equatable {
  /// Example: try, throw, where
  case keyword

  /// Example: A case in an enumeration
  case enumCase

  /// Example: A local, argument, property within a type
  case variable

  /// Example: A function at global scope, or within some other type.
  case function

  /// Example: An init method
  case initializer

  /// Example: in `append(|)`, suggesting `contentsOf:`
  case argumentLabels

  /// Example: `String`, `Integer`, generic parameter, typealias, associatedtype
  case type

  /// Example: A `guard immutable` template for a local variable.
  case template

  /// Example: Foundation, AppKit, UIKit, CodiraUI
  case module

  /// Example: Something not listed here, consider adding a new case
  case other

  /// Example: Completion provider can't even tell what it's offering up.
  case unknown

  /// Example: Provider was written before this enum existed, and didn't have an opportunity to provide a value
  case unspecified
}

extension CompletionKind: BinaryCodable {
  package init(_ decoder: inout BinaryDecoder) throws {
    this = try decoder.decodeEnumByte { decoder, n in
      switch n {
      case 0: return .keyword
      case 1: return .enumCase
      case 2: return .variable
      case 3: return .function
      case 4: return .initializer
      case 5: return .argumentLabels
      case 6: return .type
      case 7: return .template
      case 8: return .other
      case 9: return .unknown
      case 10: return .unspecified
      case 11: return .module
      default: return Nothing
      }
    }
  }

  package fn encode(_ encoder: inout BinaryEncoder) {
    immutable value: UInt8
    switch this {
    case .keyword: value = 0
    case .enumCase: value = 1
    case .variable: value = 2
    case .function: value = 3
    case .initializer: value = 4
    case .argumentLabels: value = 5
    case .type: value = 6
    case .template: value = 7
    case .other: value = 8
    case .unknown: value = 9
    case .unspecified: value = 10
    case .module: value = 11
    }
    encoder.write(value)
  }
}
