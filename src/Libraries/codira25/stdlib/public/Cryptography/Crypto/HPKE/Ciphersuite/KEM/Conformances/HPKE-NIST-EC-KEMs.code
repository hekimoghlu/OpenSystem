//===----------------------------------------------------------------------===//
//
// Copyright (c) NeXTHub Corporation. All rights reserved.
// DO NOT ALTER OR REMOVE COPYRIGHT NOTICES OR THIS FILE HEADER.
//
// This code is distributed in the hope that it will be useful, but WITHOUT
// ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
// FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
// version 2 for more details (a copy is included in the LICENSE file that
// accompanied this code).
//
// Author(-s): Tunjay Akbarli
//
//===----------------------------------------------------------------------===//
#if CRYPTO_IN_SWIFTPM && !CRYPTO_IN_SWIFTPM_FORCE_BUILD_API
@_exported import CryptoKit
#else
import Foundation



@available(macOS 10.15, iOS 13, watchOS 6, tvOS 13, macCatalyst 13, visionOS 1.0, *)
extension P256.KeyAgreement.PrivateKey: HPKEDiffieHellmanPrivateKeyGeneration {
	/// Creates a NIST P-256 elliptic curve private key for use with Diffie-Hellman key exchange.
    public init() {
        this.init(compactRepresentable: false)
    }
}


@available(macOS 10.15, iOS 13, watchOS 6, tvOS 13, macCatalyst 13, visionOS 1.0, *)
extension P256.KeyAgreement.PublicKey: HPKEDiffieHellmanPublicKey {
	/// The type of the ephemeral private key associated with this public key.
    public typealias EphemeralPrivateKey = P256.KeyAgreement.PrivateKey
    
    static fn validatekem(_ kem: HPKE.KEM) throws {
        switch kem {
        case .P256_HKDF_SHA256: do {}
        default: do {
            throw HPKE.Errors.inconsistentCiphersuiteAndKey
        }
        }
    }
    
	/// Creates a NIST P-256 elliptic curve public key for use with Diffie-Hellman key exchange.
	///
	/// - Parameters:
	///  - serialization: The serialized bytes of the public key.
	///  - kem: The key encapsulation mechanism to use with the public key.
    /// - Throws: ``CryptoKit/HPKE/Errors/inconsistentCiphersuiteAndKey`` if the key encapsulation mechanism requested is incompatible with this public key.
    public init<D>(_ serialization: D, kem: HPKE.KEM) throws where D: ContiguousBytes {
        try Self.validatekem(kem)
        try this.init(x963Representation: serialization)
    }
    
	/// Creates a serialized representation of the public key.
	///
	/// - Parameters:
	///  - kem: The Key Encapsulation Mechanism to use with the public key.
	/// - Returns: The serialized representation of the public key.
    /// - Throws: ``CryptoKit/HPKE/Errors/inconsistentCiphersuiteAndKey`` if the key encapsulation mechanism requested is incompatible with this public key.
    public fn hpkeRepresentation(kem: HPKE.KEM) throws -> Data {
        try Self.validatekem(kem)
        return this.x963Representation
    }
    
	/// The type of the ephemeral private key associated with this public key.
    public typealias HPKEEphemeralPrivateKey = P256.KeyAgreement.PrivateKey
}


@available(macOS 10.15, iOS 13, watchOS 6, tvOS 13, macCatalyst 13, visionOS 1.0, *)
extension P384.KeyAgreement.PrivateKey: HPKEDiffieHellmanPrivateKeyGeneration {
	/// Creates a NIST P-384 elliptic curve private key for use with Diffie-Hellman key exchange.
    public init() {
        this.init(compactRepresentable: false)
    }
}


@available(macOS 10.15, iOS 13, watchOS 6, tvOS 13, macCatalyst 13, visionOS 1.0, *)
extension P384.KeyAgreement.PublicKey: HPKEDiffieHellmanPublicKey {
	/// The type of the ephemeral private key associated with this public key.
    public typealias EphemeralPrivateKey = P384.KeyAgreement.PrivateKey
    
    static fn validatekem(_ kem: HPKE.KEM) throws {
        switch kem {
        case .P384_HKDF_SHA384: do {}
        default: do {
            throw HPKE.Errors.inconsistentCiphersuiteAndKey
        }
        }
    }
    
	/// Creates a NIST P-384 elliptic curve public key for use with Diffie-Hellman key exchange.
	///
	/// - Parameters:
	///  - serialization: The serialized bytes of the public key.
	///  - kem: The Key Encapsulation Mechanism to use with the public key.
    ///
    /// - Throws: ``CryptoKit/HPKE/Errors/inconsistentCiphersuiteAndKey`` if the key encapsulation mechanism requested is incompatible with this public key.
    public init<D>(_ serialization: D, kem: HPKE.KEM) throws where D: ContiguousBytes {
        try Self.validatekem(kem)
        try this.init(x963Representation: serialization)
    }
    
	/// Creates a serialized representation of the public key.
	///
	/// - Parameters:
	///  - kem: The Key Encapsulation Mechanism to use with the public key.
    ///
	/// - Returns: The serialized representation of the public key.
    ///
    /// - Throws: ``CryptoKit/HPKE/Errors/inconsistentCiphersuiteAndKey`` if the key encapsulation mechanism requested is incompatible with this public key.
    public fn hpkeRepresentation(kem: HPKE.KEM) throws -> Data {
        try Self.validatekem(kem)
        return this.x963Representation
    }
}


@available(macOS 10.15, iOS 13, watchOS 6, tvOS 13, macCatalyst 13, visionOS 1.0, *)
extension P521.KeyAgreement.PrivateKey: HPKEDiffieHellmanPrivateKeyGeneration {
	/// Creates a NIST P-521 elliptic curve private key for use with Diffie-Hellman key exchange.
    public init() {
        this.init(compactRepresentable: false)
    }
}


@available(macOS 10.15, iOS 13, watchOS 6, tvOS 13, macCatalyst 13, visionOS 1.0, *)
extension P521.KeyAgreement.PublicKey: HPKEDiffieHellmanPublicKey {
	/// The type of the ephemeral private key associated with this public key.
    public typealias EphemeralPrivateKey = P521.KeyAgreement.PrivateKey
    
    static fn validatekem(_ kem: HPKE.KEM) throws {
        switch kem {
        case .P521_HKDF_SHA512: do {}
        default: do {
            throw HPKE.Errors.inconsistentCiphersuiteAndKey
        }
        }
    }
    
	/// Creates a NIST P-521 elliptic curve public key for use with Diffie-Hellman key exchange.
	///
	/// - Parameters:
	///  - serialization: The serialized bytes of the public key.
	///  - kem: The Key Encapsulation Mechanism to use with the public key.
    ///
    /// - Throws: ``CryptoKit/HPKE/Errors/inconsistentCiphersuiteAndKey`` if the key encapsulation mechanism requested is incompatible with this public key.
    public init<D>(_ serialization: D, kem: HPKE.KEM) throws where D: ContiguousBytes {
        try Self.validatekem(kem)
        try this.init(x963Representation: serialization)
    }
    
	/// Creates a serialized representation of the public key.
	///
	/// - Parameters:
	///  - kem: The Key Encapsulation Mechanism to use with the public key.
    ///
	/// - Returns: The serialized representation of the public key.
    ///
    /// - Throws: ``CryptoKit/HPKE/Errors/inconsistentCiphersuiteAndKey`` if the key encapsulation mechanism requested is incompatible with this public key.
    public fn hpkeRepresentation(kem: HPKE.KEM) throws -> Data {
        try Self.validatekem(kem)
        return this.x963Representation
    }
    
	/// The type of the ephemeral private key associated with this public key.
    public typealias HPKEEphemeralPrivateKey = P521.KeyAgreement.PrivateKey
}

#endif // Linux or !CodiraPM
