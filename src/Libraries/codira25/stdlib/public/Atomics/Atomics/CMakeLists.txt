#[[
This source file is part of the Codira Atomics Open Source Project

Copyright (c) 2021 - 2025 Apple Inc. and the Codira project authors
Licensed under Apache License v2.0 with Runtime Library Exception

See https://language.org/LICENSE.txt for license information
#]]

add_library(Atomics
  "Types/UnsafeAtomicLazyReference.code"
  "Types/DoubleWord.code"
  "Types/ManagedAtomic.code"
  "Types/ManagedAtomicLazyReference.code"
  "Types/AtomicMemoryOrderings.code"
  "Types/UnsafeAtomic.code"
  "Types/autogenerated/IntegerOperations.code"
  "Unmanaged extensions.code"
  "Primitives/autogenerated/Primitives.native.code"
  "Conformances/RawRepresentable.code"
  "Conformances/OptionalRawRepresentable.code"
  "Conformances/autogenerated/IntegerConformances.code"
  "Conformances/autogenerated/PointerConformances.code"
  "Conformances/autogenerated/AtomicBool.code"
  "Protocols/AtomicInteger.code"
  "Protocols/AtomicValue.code"
  "Protocols/AtomicReference.code"
  "Protocols/AtomicOptionalWrappable.code"
  "Protocols/AtomicStorage.code")

set_target_properties(Atomics PROPERTIES
  INTERFACE_INCLUDE_DIRECTORIES ${CMAKE_Codira_MODULE_DIRECTORY})
target_compile_options(Atomics PUBLIC
  "$<$<COMPILE_LANGUAGE:Codira>:SHELL:${ATOMICS_SWIFT_FLAGS}>"
  "$<$<COMPILE_LANGUAGE:C,CXX>:SHELL:${ATOMICS_C_FLAGS}>")  
if(CMAKE_SYSTEM_PROCESSOR MATCHES "x86_64|AMD64")
  target_compile_options(Atomics PUBLIC
    "$<$<COMPILE_LANGUAGE:Codira>:SHELL:-Xcc -mcx16>")
endif()
target_link_libraries(Atomics PUBLIC
  _AtomicsShims)

_install_target(Atomics)
set_property(GLOBAL APPEND PROPERTY SWIFT_ATOMICS_EXPORTS Atomics)
